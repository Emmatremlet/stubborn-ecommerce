{% extends 'base.html.twig' %}

{% block title %}Mon Panier
{% endblock %}

{% block body %}
	<div class="container mt-5">
		<h1 class="mb-4 text-center">Votre Panier</h1>
		{% if products is not empty %}
			<div class="table-responsive">
				<form action="{{ path('cart_update') }}" method="post">
					<table class="table table-striped table-bordered">
						<thead class="thead-dark">
							<tr>
								<th scope="col">Produit</th>
								<th scope="col">Image</th>
								<th scope="col">Prix</th>
								<th scope="col">Taille</th>
								<th scope="col">Quantité</th>
								<th scope="col">Total</th>
								<th scope="col">Action</th>
							</tr>
						</thead>
						<tbody>
							{% for product in products %}
								<tr>
									<td>{{ product.name }}</td>
									<td>
										<img src="{{ asset('images/' ~ product.image) }}" alt="{{ product.name }}" class="img-thumbnail" style="width: 50px; height: 50px;">
									</td>
									<td>{{ product.price }}
										€</td>
									<td>
										<select name="sizes[{{ product.id }}]" class="form-control">
											{% for size in product.productSizes %}
												<option value="{{ size.id }}" {% if size.id == selected_size_id[product.id] %} selected {% endif %}>{{ size.size.name }}</option>
											{% endfor %}
										</select>
									</td>
									<td>
										<input type="number" name="quantities[{{ product.id }}]" value="{{ product.quantity }}" min="1" class="form-control"/>
									</td>
									<td>{{ product.price * product.quantity }}
										€</td>
									<td>
										<a href="{{ path('cart_remove', {productId: product.id}) }}" class="btn btn-danger btn-sm">Supprimer</a>
									</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>
					<div class="d-flex justify-content-between align-items-center mt-4">
						<h3 class="text-primary">Total :</h3>
						<strong>{{ cart.getTotalPrice() }}
							€</strong>
					</div>
					<div class="d-flex justify-content-end mt-3">
						<button type="submit" class="btn btn-warning btn-lg">Mettre à jour le panier</button>
					</div>
				</form>
			</div>
			<div class="d-flex justify-content-end mt-3">
				<a href="{{ path('products') }}" class="btn btn-secondary btn-lg mr-3">Retour à la Boutique</a>
				{# <a href="{{ path('checkout') }}" class="btn btn-success btn-lg">Passer à la caisse</a> #}
			</div>
		{% else %}
			<div class="alert alert-warning mt-4 text-center">
				Votre panier est vide.
			</div>
		{% endif %}
	</div>
{% endblock %}
